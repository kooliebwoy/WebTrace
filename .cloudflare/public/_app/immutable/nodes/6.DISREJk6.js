import{c as sa,a as d,t as c,h as ye,s as b}from"../chunks/DjbUwmZ6.js";import"../chunks/9f_XfnQs.js";import{p as W,a as B,f as la,n as oa,t as P,g as a,$ as we,c as s,s as i,d as q,m as ea,e as E,i as y,r as t}from"../chunks/B2IzWbAD.js";import{s as ia,r as na,p as Aa,i as f}from"../chunks/DUzfTGf7.js";import{I as da,s as ca,a as R,r as $e,b as Pe,e as D,i as L}from"../chunks/B8NHcvEE.js";import{c as Se}from"../chunks/ZPJ77lf8.js";import{a as Fe,b as Ve,e as Ce,C as qa}from"../chunks/CSLNZcE3.js";import{t as T,f as ra,a as Ne}from"../chunks/B901RTXx.js";import{i as Re}from"../chunks/DkLlHVqE.js";import{o as ke}from"../chunks/UYv5J0YB.js";import{q as Ie}from"../chunks/iVSWiVfi.js";import{M as je}from"../chunks/BGoqmKuV.js";import{T as ta}from"../chunks/BpkEJaBZ.js";function Me(V,m){W(m,!0);let S=na(m,["$$slots","$$events","$$legacy"]);da(V,ia({name:"chevron-left"},()=>S,{iconNode:[["path",{d:"m15 18-6-6 6-6"}]],children:(w,o)=>{var h=sa(),C=la(h);ca(C,()=>m.children??oa),d(w,h)},$$slots:{default:!0}})),B()}function Ae(V,m){W(m,!0);let S=na(m,["$$slots","$$events","$$legacy"]);da(V,ia({name:"circle-alert"},()=>S,{iconNode:[["circle",{cx:"12",cy:"12",r:"10"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16"}]],children:(w,o)=>{var h=sa(),C=la(h);ca(C,()=>m.children??oa),d(w,h)},$$slots:{default:!0}})),B()}function qe(V,m){W(m,!0);let S=na(m,["$$slots","$$events","$$legacy"]);da(V,ia({name:"circle-check-big"},()=>S,{iconNode:[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335"}],["path",{d:"m9 11 3 3L22 4"}]],children:(w,o)=>{var h=sa(),C=la(h);ca(C,()=>m.children??oa),d(w,h)},$$slots:{default:!0}})),B()}var Ee=c('<div class="alert alert-error text-sm py-2"><!> <span> </span></div>'),ze=c('<span class="loading loading-spinner loading-sm"></span> <span>Validating...</span>',1),De=c("<span>Validate SPF</span>"),Le=c('<div class="flex items-center gap-2"><span> </span> <span><!> </span></div>'),Te=c('<pre class="text-sm"> </pre>'),We=c('<div class="bg-base-200 p-3 rounded-lg overflow-x-auto"></div>'),Be=c('<div class="alert alert-warning text-sm"><!> <span>No SPF records found for this domain</span></div>'),Ke=c('<span class="badge badge-error badge-sm ml-2">Invalid</span>'),Oe=c('<tr><td><span> </span></td><td class="font-mono text-sm"> <!></td><td class="hidden md:table-cell text-sm opacity-80"> </td></tr>'),Ge=c('<div class="mb-5"><h4 class="font-bold mb-2">Parsed Mechanisms</h4> <div class="overflow-x-auto"><table class="table table-zebra table-sm w-full"><thead><tr><th class="w-24">Type</th><th>Value</th><th class="hidden md:table-cell">Description</th></tr></thead><tbody></tbody></table></div></div>'),He=c('<li class="text-sm"> </li>'),Je=c('<ul class="list-disc list-inside space-y-1"></ul>'),Qe=c('<p class="text-sm opacity-70">No errors found.</p>'),Ue=c('<li class="text-sm"> </li>'),Xe=c('<ul class="list-disc list-inside space-y-1"></ul>'),Ye=c('<p class="text-sm opacity-70">No warnings found.</p>'),Ze=c("<li>Add an SPF record to protect your domain from email spoofing.</li>"),ar=c('<li>Add a "-all" mechanism as the last element to block unauthorized senders.</li>'),er=c('<li class="text-error font-medium">Replace "+all" with "-all" to prevent email spoofing!</li>'),rr=c('<li>Consider replacing "?all" with "~all" or "-all" for better security.</li>'),tr=c("<li>Add specific mechanisms (ip4, ip6, a, mx) to authorize your legitimate email servers.</li>"),sr=c("<li>Consolidate multiple SPF records into a single record to follow best practices.</li>"),lr=c('<div class="card w-full bg-base-100 shadow-xl transition-all duration-500 self-start justify-self-center"><div class="card-body p-6"><div class="flex flex-col sm:flex-row justify-between items-start sm:items-center mb-5 gap-4"><div><h3 class="text-xl font-bold"> </h3> <p class="text-sm opacity-70">SPF Record Analysis</p></div> <div class="flex flex-col items-end"><!> <progress max="100"></progress></div></div> <div class="mb-5"><h4 class="font-bold mb-2">Raw SPF Records</h4> <!></div> <!> <div class="flex flex-col md:flex-row gap-5"><div class="flex-1"><h4 class="font-bold mb-2 text-error flex items-center gap-1"><!> <span>Errors</span></h4> <!></div> <div class="flex-1"><h4 class="font-bold mb-2 text-warning flex items-center gap-1"><!> <span>Warnings</span></h4> <!></div></div> <div class="mt-4"><h4 class="font-bold mb-2">Recommendations</h4> <div class="bg-base-200 p-4 rounded-lg"><ul class="list-disc list-inside space-y-2 text-sm"><!> <!> <!> <!> <!> <!> <li>Regular SPF validation is recommended as email infrastructure changes.</li></ul></div></div></div></div>'),or=c('<div class="flex flex-col items-center justify-center gap-4 p-10 h-64"><div class="loading loading-spinner loading-lg text-warning"></div> <p class="text-base-content/70 text-center"> </p></div>'),ir=c('<div class="min-h-screen flex items-center justify-center px-4 py-6 bg-base-200"><div><div><div class="bg-warning text-warning-content p-5"><h2 class="text-2xl font-bold flex items-center gap-2"><!> SPF Validator</h2> <p class="text-sm opacity-80 mt-1">Validate SPF records for email domains</p></div> <div class="card-body p-6"><form method="post" action="?/spfCheck" class="flex flex-col gap-4"><div class="form-control"><label class="label pb-1"><span class="label-text font-medium">Domain name</span></label> <input type="text" id="domain-input" name="domain" placeholder="example.com" class="input input-bordered w-full" required> <label class="label pt-1"><span class="label-text-alt opacity-70">Enter a domain to check its SPF records</span></label></div> <!> <button type="submit" class="btn btn-warning w-full"><!></button> <a href="/" class="btn btn-outline btn-sm w-full gap-1"><!> <span>Back to tools</span></a></form></div></div> <!> <!></div></div>');function yr(V,m){W(m,!1),Aa(m,"data",8);let S=Aa(m,"form",8),v=ea(!1),w=ea(""),o=ea(null);ke(()=>{const l=document.getElementById("domain-input");l&&l.focus()});const h=()=>(E(v,!0),E(o,null),({result:l,update:n})=>{var u;l.type==="success"&&((u=l.data)!=null&&u.spfResult)&&E(o,l.data.spfResult),E(v,!1),n()});function C(l){return l>=90?"text-success":l>=70?"text-warning":"text-error"}function Ea(l){return l>=90?"progress-success":l>=70?"progress-warning":"progress-error"}function za(l,n){if(!n)return"bg-error text-error-content";switch(l){case"version":return"bg-neutral text-neutral-content";case"all":return"bg-primary text-primary-content";case"include":return"bg-secondary text-secondary-content";case"ip4":case"ip6":return"bg-info text-info-content";case"a":case"mx":return"bg-accent text-accent-content";case"redirect":return"bg-warning text-warning-content";default:return"bg-base-300 text-base-content"}}function Da(l,n){return l?n?{icon:ta,text:"Warnings",color:"text-warning"}:{icon:qe,text:"Valid",color:"text-success"}:{icon:qa,text:"Invalid",color:"text-error"}}Re();var K=ir();ye(l=>{we.title="SPF Validator | RouteKit"});var O=s(K);let va;var k=s(O);let pa;var G=s(k),fa=s(G),La=s(fa);je(La,{class:"h-6 w-6"}),y(),t(fa),y(2),t(G);var ma=i(G,2),H=s(ma),J=s(H),ua=i(s(J),2);$e(ua),y(2),t(J);var _a=i(J,2);{var Ta=l=>{var n=Ee(),u=s(n);Ae(u,{class:"h-4 w-4"});var F=i(u,2),I=s(F,!0);t(F),t(n),P(()=>b(I,S().error)),T(3,n,()=>ra),d(l,n)};f(_a,l=>{var n;(n=S())!=null&&n.error&&l(Ta)})}var z=i(_a,2),Wa=s(z);{var Ba=l=>{var n=ze();y(2),d(l,n)},Ka=l=>{var n=De();d(l,n)};f(Wa,l=>{a(v)?l(Ba):l(Ka,!1)})}t(z);var ga=i(z,2),Oa=s(ga);Me(Oa,{class:"h-4 w-4"}),y(2),t(ga),t(H),Fe(H,(l,n)=>{var u;return(u=Ce)==null?void 0:u(l,n)},()=>h),t(ma),t(k);var xa=i(k,2);{var Ga=l=>{var n=lr(),u=s(n),F=s(u),I=s(F),ba=s(I),Qa=s(ba,!0);t(ba),y(2),t(I);var ha=i(I,2),ya=s(ha);{var Ua=e=>{var r=Le();const _=q(()=>Da(a(o).isValid,a(o).hasWarnings));var g=s(r),p=s(g);t(g);var x=i(g,2),$=s(x);Se($,()=>a(_).icon,(N,M)=>{M(N,{class:"h-3 w-3"})});var j=i($);t(x),t(r),P(N=>{R(g,1,`font-bold text-2xl ${N??""}`),b(p,`${a(o).score??""}/100`),R(x,1,`badge ${a(_).color??""} badge-sm gap-1 py-2`),b(j,` ${a(_).text??""}`)},[()=>C(a(o).score)],q),d(e,r)};f(ya,e=>{e(Ua)})}var wa=i(ya,2);t(ha),t(F);var Q=i(F,2),Xa=i(s(Q),2);{var Ya=e=>{var r=We();D(r,5,()=>a(o).records.raw,L,(_,g)=>{var p=Te(),x=s(p,!0);t(p),P(()=>b(x,a(g))),d(_,p)}),t(r),d(e,r)},Za=e=>{var r=Be(),_=s(r);ta(_,{class:"h-4 w-4"}),y(2),t(r),d(e,r)};f(Xa,e=>{a(o).records.raw.length>0?e(Ya):e(Za,!1)})}t(Q);var $a=i(Q,2);{var ae=e=>{var r=Ge(),_=i(s(r),2),g=s(_),p=i(s(g));D(p,5,()=>a(o).records.parsed,L,(x,$)=>{var j=Oe(),N=s(j),M=s(N),_e=s(M,!0);t(M),t(N);var aa=i(N),ja=s(aa),ge=i(ja);{var xe=A=>{var he=Ke();d(A,he)};f(ge,A=>{a($).isValid||A(xe)})}t(aa);var Ma=i(aa),be=s(Ma,!0);t(Ma),t(j),P(A=>{R(M,1,`badge ${A??""} py-1`),b(_e,a($).type),b(ja,`${a($).value??""} `),b(be,a($).description)},[()=>za(a($).type,a($).isValid)],q),d(x,j)}),t(p),t(g),t(_),t(r),d(e,r)};f($a,e=>{a(o).records.parsed.length>0&&e(ae)})}var U=i($a,2),X=s(U),Y=s(X),ee=s(Y);qa(ee,{class:"h-4 w-4"}),y(2),t(Y);var re=i(Y,2);{var te=e=>{var r=Je();D(r,5,()=>a(o).errors,L,(_,g)=>{var p=He(),x=s(p,!0);t(p),P(()=>b(x,a(g))),d(_,p)}),t(r),d(e,r)},se=e=>{var r=Qe();d(e,r)};f(re,e=>{a(o).errors.length>0?e(te):e(se,!1)})}t(X);var Pa=i(X,2),Z=s(Pa),le=s(Z);ta(le,{class:"h-4 w-4"}),y(2),t(Z);var oe=i(Z,2);{var ie=e=>{var r=Xe();D(r,5,()=>a(o).warnings,L,(_,g)=>{var p=Ue(),x=s(p,!0);t(p),P(()=>b(x,a(g))),d(_,p)}),t(r),d(e,r)},ne=e=>{var r=Ye();d(e,r)};f(oe,e=>{a(o).warnings.length>0?e(ie):e(ne,!1)})}t(Pa),t(U);var Sa=i(U,2),Fa=i(s(Sa),2),Va=s(Fa),Ca=s(Va);{var de=e=>{var r=Ze();d(e,r)};f(Ca,e=>{a(o).records.raw.length||e(de)})}var Na=i(Ca,2);{var ce=e=>{var r=ar();d(e,r)};f(Na,e=>{a(o).records.parsed.some(r=>r.type==="all"&&r.value==="-all")||e(ce)})}var Ra=i(Na,2);{var ve=e=>{var r=er();d(e,r)};f(Ra,e=>{a(o).records.parsed.some(r=>r.type==="all"&&(r.value==="+all"||r.value==="all"))&&e(ve)})}var ka=i(Ra,2);{var pe=e=>{var r=rr();d(e,r)};f(ka,e=>{a(o).records.parsed.some(r=>r.type==="all"&&r.value==="?all")&&e(pe)})}var Ia=i(ka,2);{var fe=e=>{var r=tr();d(e,r)};f(Ia,e=>{a(o).records.parsed.some(r=>r.type==="ip4"||r.type==="ip6"||r.type==="a"||r.type==="mx")||e(fe)})}var me=i(Ia,2);{var ue=e=>{var r=sr();d(e,r)};f(me,e=>{a(o).records.raw.length>1&&e(ue)})}y(2),t(Va),t(Fa),t(Sa),t(u),t(n),P(e=>{b(Qa,a(o).domain),R(wa,1,`progress ${e??""} w-32 h-2`),Pe(wa,a(o).score)},[()=>Ea(a(o).score)],q),T(1,n,()=>Ne,()=>({y:20,duration:400,easing:Ie})),d(l,n)};f(xa,l=>{a(o)&&!a(v)&&l(Ga)})}var Ha=i(xa,2);{var Ja=l=>{var n=or(),u=i(s(n),2),F=s(u);t(u),t(n),P(()=>b(F,`Validating SPF records for ${a(w)??""}...`)),T(1,n,()=>ra,()=>({duration:200})),d(l,n)};f(Ha,l=>{a(v)&&l(Ja)})}t(O),t(K),P((l,n)=>{va=R(O,1,"w-full max-w-[1400px]",null,va,l),pa=R(k,1,"card w-[min(350px,95vw)] bg-base-100 shadow-xl transition-all duration-500",null,pa,n),z.disabled=a(v)},[()=>({flex:!a(o)&&!a(v),"items-center":!a(o)&&!a(v),"justify-center":!a(o)||a(v),grid:a(o)&&!a(v),"grid-cols-1":a(o)&&!a(v),"lg:grid-cols-2":a(o)&&!a(v),"lg:grid-cols-[minmax(350px,1fr)_minmax(500px,2fr)]":a(o)&&!a(v),"gap-6":a(o)&&!a(v),"lg:gap-10":a(o)&&!a(v)}),()=>({"self-start":a(o)&&!a(v),"justify-self-center":a(o)&&!a(v)})],q),Ve(ua,()=>a(w),l=>E(w,l)),T(1,k,()=>ra,()=>({duration:300})),d(V,K),B()}export{yr as component};
