import{d as pe,t as v,a as i,s as g,c as fe}from"../chunks/DjbUwmZ6.js";import"../chunks/9f_XfnQs.js";import{p as me,l as ca,b as ue,f as za,c as t,t as A,g as a,a as xe,d as K,m as Q,s as r,e as j,h as _a,i as V,r as e}from"../chunks/B2IzWbAD.js";import{p as Va,i as b}from"../chunks/DUzfTGf7.js";import{a as E,r as ge,e as ia,i as oa,b as he,c as ye}from"../chunks/B8NHcvEE.js";import{a as we,b as ke,e as Ce,C as je}from"../chunks/CSLNZcE3.js";import{t as ba,f as Ea,s as He,a as Se}from"../chunks/B901RTXx.js";import{i as Te}from"../chunks/DkLlHVqE.js";import{g as Ae}from"../chunks/CyDalvIn.js";import{G as Ma}from"../chunks/CknH3e5v.js";import{A as Pe}from"../chunks/-MBee31-.js";import{C as Fa}from"../chunks/B7o4KOHs.js";var Oe=(W,h)=>j(h,""),ze=v('<button type="button" class="absolute right-2 top-1/2 -translate-y-1/2 btn btn-ghost btn-xs btn-circle" aria-label="Clear input">âœ•</button>'),Me=v('<span class="loading loading-spinner loading-sm absolute"></span> <span class="opacity-0">Check Headers</span>',1),qe=v("<!> Check Headers",1),De=()=>Ae("/"),Ge=v('<div class="alert alert-error mt-2 shadow-md"><!> <span> </span></div>'),Le=v("<span> </span>"),Ne=(W,h)=>j(h,"all"),Ue=(W,h)=>j(h,"security"),Be=(W,h)=>j(h,"cache"),Je=(W,h)=>j(h,"server"),Re=(W,h,d)=>h(JSON.stringify(a(d),null,2)),Ve=v('<tr><td class="font-mono text-xs whitespace-nowrap"> </td><td class="font-mono text-xs break-all"> </td></tr>'),Ee=v('<div class="space-y-1"><div class="flex justify-between items-center mb-3"><h4 class="text-sm font-semibold text-base-content/70 uppercase">All Headers</h4> <button class="btn btn-xs btn-ghost"><!> Copy All</button></div> <div class="overflow-x-auto"><table class="table table-zebra table-sm w-full"><thead><tr><th class="w-1/3">Header</th><th>Value</th></tr></thead><tbody></tbody></table></div></div>'),Fe=v('<div class="mb-6"><h4 class="text-sm font-semibold mb-2 text-base-content/70 uppercase">Security Score</h4> <div class="flex flex-col gap-3"><div class="flex items-center justify-between"><span class="text-sm font-semibold"> </span> <span> </span></div> <progress></progress></div></div>'),Ie=v('<span class="badge badge-success badge-sm">Present</span>'),Ke=v('<span class="badge badge-error badge-sm">Missing</span>'),Qe=v('<div class="mt-1 font-mono text-xs break-all"> </div>'),We=v('<div class="mt-1 italic text-xs opacity-70">This security header is not present</div>'),Xe=v('<div class="bg-base-200 p-3 rounded-md"><div class="flex items-center justify-between"><span class="font-mono text-sm"> </span> <!></div> <!></div>'),Ye=v('<div><!> <h4 class="text-sm font-semibold mb-2 text-base-content/70 uppercase">Security Headers</h4> <div class="space-y-3"></div></div>'),Ze=v('<span class="badge badge-success badge-sm">Present</span>'),$e=v('<span class="badge badge-warning badge-sm">Missing</span>'),at=v('<div class="mt-1 font-mono text-xs break-all"> </div>'),et=v('<div class="mt-1 italic text-xs opacity-70">This cache header is not present</div>'),tt=v('<div class="bg-base-200 p-3 rounded-md"><div class="flex items-center justify-between"><span class="font-mono text-sm"> </span> <!></div> <!></div>'),st=v('<div><h4 class="text-sm font-semibold mb-2 text-base-content/70 uppercase">Cache Headers</h4> <div class="space-y-3"></div></div>'),rt=v('<span class="badge badge-info badge-sm">Present</span>'),it=v('<span class="badge badge-ghost badge-sm">Missing</span>'),ot=v('<div class="mt-1 font-mono text-xs break-all"> </div>'),vt=v('<div class="mt-1 italic text-xs opacity-70">This server header is not present</div>'),lt=v('<div class="bg-base-200 p-3 rounded-md"><div class="flex items-center justify-between"><span class="font-mono text-sm"> </span> <!></div> <!></div>'),nt=v('<div class="bg-base-200 p-3 rounded-md"><div class="flex items-center justify-between"><span class="font-mono text-sm"> </span> <span class="badge badge-primary badge-sm">Present</span></div> <div class="mt-1 font-mono text-xs break-all"> </div></div>'),dt=v('<div><h4 class="text-sm font-semibold mb-2 text-base-content/70 uppercase">Server Headers</h4> <div class="space-y-3"></div> <div class="mt-6"><h4 class="text-sm font-semibold mb-2 text-base-content/70 uppercase">Content Headers</h4> <div class="space-y-3"></div></div></div>'),ct=v('<div class="card w-full bg-base-100 shadow-xl self-start overflow-hidden"><div class="bg-base-200 p-4 border-b border-base-300 flex justify-between items-center"><h3 class="text-lg font-semibold flex items-center gap-2"><!> <span class="font-mono text-sm truncate"> </span></h3> <div class="flex gap-1"><span class="badge badge-sm"> </span> <!></div></div> <div class="tabs tabs-boxed bg-base-100 rounded-none px-4 pt-4"><button>All Headers</button> <button>Security</button> <button>Cache</button> <button>Server</button></div> <div class="p-6"><!></div></div>'),_t=v('<div class="toast toast-top toast-center"><div class="alert alert-success"><!> <span>Copied to clipboard!</span></div></div>'),bt=v('<div class="min-h-screen bg-base-200 flex flex-col items-center justify-center p-4 sm:p-6"><div><div><div class="bg-success text-success-content p-5"><h2 class="text-2xl font-bold flex items-center gap-2"><!> HTTP Headers</h2> <p class="text-sm opacity-80 mt-1">Analyze HTTP response headers</p></div> <div class="card-body p-6"><form method="post" action="?/headersCheck" class="flex flex-col gap-4"><div class="form-control"><label class="label pb-1"><span class="label-text font-medium">Domain or URL</span></label> <div class="relative"><input type="text" class="input input-bordered w-full pr-12 font-mono text-sm" name="url" placeholder="example.com" required minlength="4"> <!></div> <label class="label pt-0"><span class="label-text-alt">Protocol (http://) will be added if missing</span></label></div> <button class="btn btn-success w-full mt-4 relative overflow-hidden" type="submit"><!></button> <div class="mt-2"><button type="button" class="btn btn-ghost btn-xs w-full flex justify-center items-center gap-2"><!> Back to tools</button></div> <!></form></div></div> <!></div></div> <!>',1);function Ht(W,h){me(h,!1);const d=Q(),aa=Q(),H=Q(),pa=Q();Va(h,"data",8);let M=Va(h,"form",8),va=Q(""),c=Q(!1),fa=Q(!1),P=Q("all");function Ia({form:s,data:o,action:y,cancel:N,submitter:sa}){return j(c,!0),async({result:Ca,update:ja})=>{j(c,!1),await ja()}}function Ka(s){navigator.clipboard.writeText(s),j(fa,!0),setTimeout(()=>j(fa,!1),2e3)}function ma(s){return s>=80?"success":s>=60?"warning":s>=40?"info":"error"}function ea(s){return s.split("-").map(o=>o.charAt(0).toUpperCase()+o.slice(1)).join("-")}ca(()=>_a(M()),()=>{var s;j(d,(s=M())==null?void 0:s.allHeaders)}),ca(()=>_a(M()),()=>{var s;j(aa,(s=M())==null?void 0:s.categorizedHeaders)}),ca(()=>_a(M()),()=>{var s;j(H,(s=M())==null?void 0:s.securityScore)}),ca(()=>_a(M()),()=>{var s;j(pa,(s=M())==null?void 0:s.error)}),ue(),Te();var qa=bt(),ua=za(qa),xa=t(ua);let Da;var ta=t(xa);let Ga;var ga=t(ta),La=t(ga),Qa=t(La);Ma(Qa,{class:"h-6 w-6"}),V(),e(La),V(2),e(ga);var Na=r(ga,2),ha=t(Na),ya=t(ha),Ua=r(t(ya),2),la=t(Ua);ge(la);var Wa=r(la,2);{var Xa=s=>{var o=ze();o.__click=[Oe,va],i(s,o)};b(Wa,s=>{a(va)&&s(Xa)})}e(Ua),V(2),e(ya);var na=r(ya,2),Ya=t(na);{var Za=s=>{var o=Me();V(2),i(s,o)},$a=s=>{var o=qe(),y=za(o);Ma(y,{class:"w-4 h-4 mr-2"}),V(),i(s,o)};b(Ya,s=>{a(c)?s(Za):s($a,!1)})}e(na);var wa=r(na,2),ka=t(wa);ka.__click=[De];var ae=t(ka);Pe(ae,{class:"w-3 h-3"}),V(),e(ka),e(wa);var ee=r(wa,2);{var te=s=>{var o=Ge(),y=t(o);je(y,{class:"w-5 h-5"});var N=r(y,2),sa=t(N,!0);e(N),e(o),A(()=>g(sa,a(pa))),ba(3,o,()=>He),i(s,o)};b(ee,s=>{a(pa)&&s(te)})}e(ha),we(ha,(s,o)=>{var y;return(y=Ce)==null?void 0:y(s,o)},()=>Ia),e(Na),e(ta);var se=r(ta,2);{var re=s=>{var o=ct(),y=t(o),N=t(y),sa=t(N);Ma(sa,{class:"w-5 h-5"});var Ca=r(sa,2),ja=t(Ca,!0);e(Ca),e(N);var Ba=r(N,2),Ha=t(Ba),ve=t(Ha);e(Ha);var le=r(Ha,2);{var ne=D=>{var G=Le(),X=t(G);e(G),A(Y=>{E(G,1,`badge badge-sm badge-${Y??""}`),g(X,`Security: ${a(H).score??""}/${a(H).max??""}`)},[()=>ma(a(H).score)],K),i(D,G)};b(le,D=>{a(H)&&D(ne)})}e(Ba),e(y);var Sa=r(y,2),Ta=t(Sa);Ta.__click=[Ne,P];var Aa=r(Ta,2);Aa.__click=[Ue,P];var Pa=r(Aa,2);Pa.__click=[Be,P];var Ja=r(Pa,2);Ja.__click=[Je,P],e(Sa);var Ra=r(Sa,2),de=t(Ra);{var ce=D=>{var G=Ee(),X=t(G),Y=r(t(X),2);Y.__click=[Re,Ka,d];var F=t(Y);Fa(F,{class:"w-3.5 h-3.5 mr-1"}),V(),e(Y),e(X);var I=r(X,2),Z=t(I),$=r(t(Z));ia($,5,()=>Object.entries(a(d)),oa,(q,w)=>{let S=()=>a(w)[0],O=()=>a(w)[1];var _=Ve(),p=t(_),k=t(p,!0);e(p);var f=r(p),T=t(f,!0);e(f),e(_),A(m=>{g(k,m),g(T,O())},[()=>ea(S())],K),i(q,_)}),e($),e(Z),e(I),e(G),i(D,G)},_e=(D,G)=>{{var X=F=>{var I=Ye(),Z=t(I);{var $=w=>{var S=Fe(),O=r(t(S),2),_=t(O),p=t(_),k=t(p);e(p);var f=r(p,2),T=t(f,!0);e(f),e(_);var m=r(_,2);e(O),e(S),A((U,z)=>{g(k,`${a(H).score??""}/${a(H).max??""}`),E(f,1,`badge badge-${U??""}`),g(T,a(H).category),E(m,1,`progress progress-${z??""}`),he(m,a(H).score),ye(m,"max",a(H).max)},[()=>ma(a(H).score),()=>ma(a(H).score)],K),i(w,S)};b(Z,w=>{a(H)&&w($)})}var q=r(Z,4);ia(q,5,()=>Object.entries(a(aa).security),oa,(w,S)=>{let O=()=>a(S)[0],_=()=>a(S)[1];var p=Xe(),k=t(p),f=t(k),T=t(f,!0);e(f);var m=r(f,2);{var U=l=>{var u=Ie();i(l,u)},z=l=>{var u=Ke();i(l,u)};b(m,l=>{_()?l(U):l(z,!1)})}e(k);var L=r(k,2);{var B=l=>{var u=Qe(),n=t(u,!0);e(u),A(()=>g(n,_())),i(l,u)},J=l=>{var u=We();i(l,u)};b(L,l=>{_()?l(B):l(J,!1)})}e(p),A(l=>g(T,l),[()=>ea(O())],K),i(w,p)}),e(q),e(I),i(F,I)},Y=(F,I)=>{{var Z=q=>{var w=st(),S=r(t(w),2);ia(S,5,()=>Object.entries(a(aa).cache),oa,(O,_)=>{let p=()=>a(_)[0],k=()=>a(_)[1];var f=tt(),T=t(f),m=t(T),U=t(m,!0);e(m);var z=r(m,2);{var L=n=>{var C=Ze();i(n,C)},B=n=>{var C=$e();i(n,C)};b(z,n=>{k()?n(L):n(B,!1)})}e(T);var J=r(T,2);{var l=n=>{var C=at(),ra=t(C,!0);e(C),A(()=>g(ra,k())),i(n,C)},u=n=>{var C=et();i(n,C)};b(J,n=>{k()?n(l):n(u,!1)})}e(f),A(n=>g(U,n),[()=>ea(p())],K),i(O,f)}),e(S),e(w),i(q,w)},$=(q,w)=>{{var S=O=>{var _=dt(),p=r(t(_),2);ia(p,5,()=>Object.entries(a(aa).server),oa,(T,m)=>{let U=()=>a(m)[0],z=()=>a(m)[1];var L=lt(),B=t(L),J=t(B),l=t(J,!0);e(J);var u=r(J,2);{var n=x=>{var R=rt();i(x,R)},C=x=>{var R=it();i(x,R)};b(u,x=>{z()?x(n):x(C,!1)})}e(B);var ra=r(B,2);{var da=x=>{var R=ot(),be=t(R,!0);e(R),A(()=>g(be,z())),i(x,R)},Oa=x=>{var R=vt();i(x,R)};b(ra,x=>{z()?x(da):x(Oa,!1)})}e(L),A(x=>g(l,x),[()=>ea(U())],K),i(T,L)}),e(p);var k=r(p,2),f=r(t(k),2);ia(f,5,()=>Object.entries(a(aa).content),oa,(T,m)=>{let U=()=>a(m)[0],z=()=>a(m)[1];var L=fe(),B=za(L);{var J=l=>{var u=nt(),n=t(u),C=t(n),ra=t(C,!0);e(C),V(2),e(n);var da=r(n,2),Oa=t(da,!0);e(da),e(u),A(x=>{g(ra,x),g(Oa,z())},[()=>ea(U())],K),i(l,u)};b(B,l=>{z()&&l(J)})}i(T,L)}),e(f),e(k),e(_),i(O,_)};b(q,O=>{a(P)==="server"&&O(S)},w)}};b(F,q=>{a(P)==="cache"?q(Z):q($,!1)},I)}};b(D,F=>{a(P)==="security"?F(X):F(Y,!1)},G)}};b(de,D=>{a(P)==="all"?D(ce):D(_e,!1)})}e(Ra),e(o),A(()=>{g(ja,M().url),g(ve,`Status: ${M().statusCode??""} ${M().statusText??""}`),E(Ta,1,`tab ${a(P)==="all"?"tab-active":""}`),E(Aa,1,`tab ${a(P)==="security"?"tab-active":""}`),E(Pa,1,`tab ${a(P)==="cache"?"tab-active":""}`),E(Ja,1,`tab ${a(P)==="server"?"tab-active":""}`)}),ba(1,o,()=>Se,()=>({x:20,duration:300,delay:150})),i(s,o)};b(se,s=>{a(d)&&!a(c)&&s(re)})}e(xa),e(ua);var ie=r(ua,2);{var oe=s=>{var o=_t(),y=t(o),N=t(y);Fa(N,{class:"w-4 h-4"}),V(2),e(y),e(o),ba(3,o,()=>Ea),i(s,o)};b(ie,s=>{a(fa)&&s(oe)})}A((s,o)=>{Da=E(xa,1,"w-full max-w-[1400px] transition-all duration-500",null,Da,s),Ga=E(ta,1,"card w-[min(350px,95vw)] bg-base-100 shadow-xl transition-all duration-500",null,Ga,o),la.disabled=a(c),na.disabled=a(c)},[()=>({flex:!a(d)||a(c),"flex-col":!a(d)||a(c),"items-center":!a(d)||a(c),"justify-center":!a(d)||a(c),grid:a(d)&&!a(c),"grid-cols-1":a(d)&&!a(c),"lg:grid-cols-2":a(d)&&!a(c),"lg:grid-cols-[minmax(350px,1fr)_minmax(500px,2fr)]":a(d)&&!a(c),"gap-6":a(d)&&!a(c),"lg:gap-10":a(d)&&!a(c)}),()=>({"self-start":a(d)&&!a(c),"justify-self-center":a(d)&&!a(c)})],K),ke(la,()=>a(va),s=>j(va,s)),ba(1,ta,()=>Ea,()=>({duration:300})),i(W,qa),xe()}pe(["click"]);export{Ht as component};
